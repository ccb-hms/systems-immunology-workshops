<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Systems Immunology Workshops - 18&nbsp; Matching and Reordering Data in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../session3/tidyverse.html" rel="next">
<link href="../session3/wrangling.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Matching and Reordering Data in R</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Systems Immunology Workshops</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Systems Immunology Workshops</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../preWork/pre_work.html" class="sidebar-item-text sidebar-link">Pre-Work</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preWork/install.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Installing R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../preWork/rstudio.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to RStudio</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session1/session1.html" class="sidebar-item-text sidebar-link">Session 1: Data Types and Hypothesis Tests</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R Syntax and Data Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Probability Primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/hypo_tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Distributions to Hypothesis Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/factors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Categorical Data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/choosing_tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Performing and choosing hypothesis tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session1/pSet1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Problem Set 1</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session2/session2.html" class="sidebar-item-text sidebar-link">Session 2: Functions and Multiple Hypothesis Correction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/packages.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Packages and Libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/loading_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reading data into R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/pvals.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">P Values and Multiple Hypotheses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/mult.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Multiple Hypothesis Correction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/making_functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/session2problems.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Practice Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session2/pSet2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Problem Set 2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session3/session3.html" class="sidebar-item-text sidebar-link">Session 3: Data Wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3/count_data1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Count Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3/wrangling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3/matching_reordering.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Matching and Reordering Data in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3/tidyverse.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Tidyverse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session3/pSet3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Problem Set 3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session4/session4.html" class="sidebar-item-text sidebar-link">Session 4: Data visualization in R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4/linear_models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Linear Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4/ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Data Visualization in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4/exporting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Saving Data and Figures in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4/other_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Common visualizations in biological analyses</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session4/pSet4.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Problem Set 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session5/session5.html" class="sidebar-item-text sidebar-link">Session 5: Bulk RNA-seq</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5/summarized_experiment.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Working with summarized experimental data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5/de_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Differential expression analysis with DESeq2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5/enrichment_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Functional enrichment analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session5/pset5.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Problem Set 5</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session6/session6.html" class="sidebar-item-text sidebar-link">Session 6: scRNA-seq 1</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session6/osca.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Single-cell analysis with Bioconductor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session6/pSet6.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Problem Set 6</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../session7/session7.html" class="sidebar-item-text sidebar-link">Session 7: scRNA-seq 2</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session7/seurat.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Single-cell analysis with Seurat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session7/pSet7.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Problem set 7: Seurat</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../resources/resources.html" class="sidebar-item-text sidebar-link">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/git.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Getting Started with Git &amp; Github</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#logical-operators-for-identifying-matching-elements" id="toc-logical-operators-for-identifying-matching-elements" class="nav-link active" data-scroll-target="#logical-operators-for-identifying-matching-elements"><span class="toc-section-number">18.1</span>  Logical operators for identifying matching elements</a></li>
  <li><a href="#the-in-operator" id="toc-the-in-operator" class="nav-link" data-scroll-target="#the-in-operator"><span class="toc-section-number">18.2</span>  The <code>%in%</code> operator</a></li>
  <li><a href="#reordering-data-using-match" id="toc-reordering-data-using-match" class="nav-link" data-scroll-target="#reordering-data-using-match"><span class="toc-section-number">18.3</span>  Reordering data using <code>match</code></a>
  <ul class="collapse">
  <li><a href="#reordering-genomic-data-using-match-function" id="toc-reordering-genomic-data-using-match-function" class="nav-link" data-scroll-target="#reordering-genomic-data-using-match-function"><span class="toc-section-number">18.3.1</span>  Reordering genomic data using <code>match()</code> function</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Matching and Reordering Data in R</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="logical-operators-for-identifying-matching-elements" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="logical-operators-for-identifying-matching-elements"><span class="header-section-number">18.1</span> Logical operators for identifying matching elements</h2>
<p>Oftentimes, we encounter different analysis tools that require multiple input datasets. It is not uncommon for these inputs to need to have the same row names, column names, or unique identifiers in the same order to perform the analysis. Therefore, knowing how to reorder datasets and determine whether the data matches is an important skill.</p>
<p>In our use case, we will be working with genomic data. We have gene expression data generated by RNA-seq; in addition, we have a metadata file corresponding to the RNA-seq samples. The metadata contains information about the samples present in the gene expression file, such as which sample group each sample belongs to and any batch or experimental variables present in the data.</p>
<p>Let’s read in some gene expression data (RPKM matrix):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>rpkm_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/counts.rpkm"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"../data/mouse_exp_design.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> If the data file name ends with <code>txt</code> instead of <code>csv</code>, you can read in the data using the code: <code>rpkm_data &lt;- read.csv("../data/counts.rpkm.txt")</code>.</p>
</blockquote>
<p>Take a look at the first few lines of the data matrix to see what’s in there.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rpkm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     sample2    sample5  sample7   sample8   sample9   sample4
ENSMUSG00000000001 19.265000 23.7222000 2.611610 5.8495400 6.5126300 24.076700
ENSMUSG00000000003  0.000000  0.0000000 0.000000 0.0000000 0.0000000  0.000000
ENSMUSG00000000028  1.032290  0.8269540 1.134410 0.6987540 0.9251170  0.827891
ENSMUSG00000000031  0.000000  0.0000000 0.000000 0.0298449 0.0597726  0.000000
ENSMUSG00000000037  0.056033  0.0473238 0.000000 0.0685938 0.0494147  0.180883
ENSMUSG00000000049  0.258134  1.0730200 0.252342 0.2970320 0.2082800  2.191720
                      sample6   sample12   sample3   sample11  sample10
ENSMUSG00000000001 20.8198000 26.9158000 20.889500 24.0465000 24.198100
ENSMUSG00000000003  0.0000000  0.0000000  0.000000  0.0000000  0.000000
ENSMUSG00000000028  1.1686300  0.6735630  0.892183  0.9753270  1.045920
ENSMUSG00000000031  0.0511932  0.0204382  0.000000  0.0000000  0.000000
ENSMUSG00000000037  0.1438840  0.0662324  0.146196  0.0206405  0.017004
ENSMUSG00000000049  1.6853800  0.1161970  0.421286  0.0634322  0.369550
                      sample1
ENSMUSG00000000001 19.7848000
ENSMUSG00000000003  0.0000000
ENSMUSG00000000028  0.9377920
ENSMUSG00000000031  0.0359631
ENSMUSG00000000037  0.1514170
ENSMUSG00000000049  0.2567330</code></pre>
</div>
</div>
<p>It looks as if the sample names (header) in our data matrix are similar to the row names of our metadata file, but it’s hard to tell since they are not in the same order. We can do a quick check of the number of columns in the count data and the rows in the metadata and at least see if the numbers match up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(rpkm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
<p>What we want to know is, <strong>do we have data for every sample that we have metadata?</strong></p>
</section>
<section id="the-in-operator" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="the-in-operator"><span class="header-section-number">18.2</span> The <code>%in%</code> operator</h2>
<p>Although lacking in <a href="http://dr-k-lo.blogspot.com/2013/11/">documentation</a>, this operator is well-used and convenient once you get the hang of it. The operator is used with the following syntax:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="sc">%in%</span> vector2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It will take each element from vector1 as input, one at a time, and <strong>evaluate if the element is present in vector2.</strong> <em>The two vectors do not have to be the same size.</em> This operation will return a vector containing logical values to indicate whether or not there is a match. The new vector will be of the same length as vector1. Take a look at the example below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)   <span class="co"># odd numbers</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>)  <span class="co"># even numbers</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test to see if each of the elements of A is in B  </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%in%</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Since vector A contains only odd numbers and vector B contains only even numbers, the operation returns a logical vector containing six <code>FALSE</code>, suggesting that no element in vector A is present in vector B. Let’s change a couple of numbers inside vector B to match vector A:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>)   <span class="co"># odd numbers</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">5</span>)  <span class="co"># add some odd numbers in </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test to see if each of the elements of A is in B</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%in%</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>The returned logical vector denotes which elements in <code>A</code> are also in <code>B</code> - the first and third elements, which are 1 and 5.</p>
<p>We saw previously that we could use the output from a logical expression to subset data by returning only the values corresponding to <code>TRUE</code>. Therefore, we can use the output logical vector to subset our data, and return only those elements in <code>A</code>, which are also in <code>B</code> by returning only the TRUE values:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/in-operator1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">matching1</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>intersection <span class="ot">&lt;-</span> A <span class="sc">%in%</span> B</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>intersection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE FALSE FALSE</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/in-operator2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">matching2</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>A[intersection]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 5</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/in-operator3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">matching3</figcaption><p></p>
</figure>
</div>
<p>In these previous examples, the vectors were so small that it’s easy to check every logical value by eye; but this is not practical when we work with large datasets (e.g.&nbsp;a vector with 1000 logical values). Instead, we can use <code>any</code> function. Given a logical vector, this function will tell you whether <strong>at least one value</strong> is <code>TRUE</code>. It provides us a quick way to assess if <strong>any of the values contained in vector A are also in vector B</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(A <span class="sc">%in%</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>The <code>all</code> function is also useful. Given a logical vector, it will tell you whether <strong>all values</strong> are <code>TRUE</code>. If there is at least one <code>FALSE</code> value, the <code>all</code> function will return a <code>FALSE</code>. We can use this function to assess whether <strong>all elements from vector A are contained in vector B</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(A <span class="sc">%in%</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Suppose we had two vectors containing same values. How can we check <strong>if those values are in the same order in each vector</strong>? In this case, we can use <code>==</code> operator to compare each element of the same position from two vectors. The operator returns a logical vector indicating TRUE/FALSE at each position. Then we can use <code>all()</code> function to check if all values in the returned vector are TRUE. If all values are TRUE, we know that these two vectors are the same. Unlike <code>%in%</code> operator, <code>==</code> operator requires that <strong>two vectors are of equal length</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">40</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">10</span>)  <span class="co"># same numbers but backwards </span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># test to see if each element of A is in B</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%in%</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test to see if each element of A is in the same position in B</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">==</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use all() to check if they are a perfect match</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(A <span class="sc">==</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Let’s try this on our genomic data, and see whether we have metadata information for all samples in our expression data. We’ll start by creating two vectors: one is the <code>rownames</code> of the metadata, and one is the <code>colnames</code> of the RPKM data. These are base functions in R which allow you to extract the row and column names as a vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rownames</span>(metadata)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rpkm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now check to see that all of <code>x</code> are in <code>y</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(x <span class="sc">%in%</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p><em>Note that we can use nested functions in place of <code>x</code> and <code>y</code> and still get the same result:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">rownames</span>(metadata) <span class="sc">%in%</span> <span class="fu">colnames</span>(rpkm_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>We know that all samples are present, but are they in the same order?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(x <span class="sc">==</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p><strong>Exercise</strong></p>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Basic
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have a list of 6 marker genes that we are very interested in. Our goal is to extract count data for these genes using the <code>%in%</code> operator from the <code>rpkm_data</code> data frame, instead of scrolling through <code>rpkm_data</code> and finding them manually.</p>
<p>First, let’s create a vector called <code>important_genes</code> with the Ensembl IDs of the 6 genes we are interested in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>important_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ENSMUSG00000083700"</span>, <span class="st">"ENSMUSG00000080990"</span>, <span class="st">"ENSMUSG00000065619"</span>, <span class="st">"ENSMUSG00000047945"</span>, <span class="st">"ENSMUSG00000081010"</span>, <span class="st">"ENSMUSG00000030970"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Use the <code>%in%</code> operator to determine if all of these genes are present in the row names of the <code>rpkm_data</code> dataframe.</p></li>
<li><p>Extract the rows from <code>rpkm_data</code> that correspond to these 6 genes using <code>[]</code> and the <code>%in%</code> operator. Double check the row names to ensure that you are extracting the correct rows.</p></li>
<li><p>Extract the rows from <code>rpkm_data</code> that correspond to these 6 genes using <code>[]</code>, but without using the <code>%in%</code> operator.</p></li>
</ol>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>important_genes <span class="sc">%in%</span> <span class="fu">rownames</span>(rpkm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">rownames</span>(rpkm_data) <span class="sc">%in%</span> important_genes</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> rpkm_data[idx, ]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>idx2 <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rownames</span>(rpkm_data) <span class="sc">%in%</span> important_genes)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>ans2 <span class="ot">&lt;-</span> rpkm_data[idx2, ]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#3.</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>ans3 <span class="ot">&lt;-</span> rpkm_data[important_genes, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-caution callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Advanced
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using <code>important_genes</code> as defined above, check whether or not the genes which in the <code>rpkm_data</code> dataframe are in <em>the same order</em> as <code>important_genes</code>. Return a vector indicating, for each important gene in <code>important_genes</code>, whether or not its order rank is the same as it’s order rank in <code>rpkm_data</code>, i.e.&nbsp;whether or not the second gene in <code>important_genes</code> is also the second important gene to appear in <code>rpkm_data</code>.</p>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is actually very simple to do, given the basic solutions</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans2) <span class="sc">==</span> <span class="fu">rownames</span>(ans3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout-important callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge
</div>
</div>
<div class="callout-body-container callout-body">
<p>You are already upset with your collaborator for giving you data which uses Ensembl IDs as identifiers (we will convert these IDs soon). They then write down 2 genes of interest for you to look for in the dataset before leaving on vacation.</p>
<p>When you look at the gene list a few days later, you realize you cannot make out some of their handwriting. You decipher what you can, but realize there are some digits you simply cannot interpret.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>collaborator_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ENSMUSG00000081**0"</span>, <span class="st">"ENSMUSG00000030*7*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find all genes in <code>rpkm_data</code> which match these two identifiers, where <code>*</code> could be replaced with any single 0-9 digit.</p>
<p><em>Hint: You’ll probably want to use something like <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/grep">grep</a>, which can pattern match based on <a href="https://cran.r-project.org/web/packages/stringr/vignettes/regular-expressions.html">regular expressions</a>. You can make sure you have the right regular expression <a href="https://regexlearn.com/playground?id=63ec345438ebd467bfb0ac1e">regular here</a></em></p>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>regexes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ENSMUSG00000081</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d0"</span>, <span class="st">"ENSMUSG00000030</span><span class="sc">\\</span><span class="st">d7</span><span class="sc">\\</span><span class="st">d"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>rpkm_data[<span class="fu">grep</span>(regexes[<span class="dv">1</span>], <span class="fu">rownames</span>(rpkm_data)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      sample2     sample5      sample7   sample8      sample9
ENSMUSG00000081000 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081010 0.22227500 3.49415e-01  1.90397e-01 0.1671660  2.21353e-01
ENSMUSG00000081020 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081030 0.00000000 0.00000e+00  0.00000e+00 0.1223340  0.00000e+00
ENSMUSG00000081050 0.02785810 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081060 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081070 0.09740580 1.44535e-01  1.25448e-01 0.1353490  1.99690e-01
ENSMUSG00000081080 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081100 0.27463500 6.61332e-01  0.00000e+00 0.2855090  2.19711e+00
ENSMUSG00000081110 0.39801600 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081120 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081130 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081150 0.10121900 2.01987e-02  1.31797e-01 0.0673127  4.44992e-02
ENSMUSG00000081160 0.00000000 0.00000e+00  0.00000e+00 0.0000000  3.32879e-01
ENSMUSG00000081170 0.00000000 4.00769e-02  5.13139e-02 0.0000000  5.67826e-02
ENSMUSG00000081180 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081200 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081210 0.00000000 3.44678e-02  0.00000e+00 0.0588781  2.46227e-02
ENSMUSG00000081220 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081230 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081240 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081250 0.05572640 4.34706e-02  4.36641e-01 0.1093740  1.12035e-01
ENSMUSG00000081260 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081270 0.06923800 5.74667e-02  0.00000e+00 0.1305830  2.13832e-02
ENSMUSG00000081280 0.00000000 0.00000e+00  0.00000e+00 0.0676693  0.00000e+00
ENSMUSG00000081290 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081300 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081310 0.00000000 0.00000e+00  5.18181e-02 0.0000000  0.00000e+00
ENSMUSG00000081320 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081330 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081340 0.64417200 4.34211e-01  2.37312e-01 0.4893080  2.15859e-01
ENSMUSG00000081350 0.03330220 1.01136e-01  1.83130e-01 0.0340187  1.46664e-02
ENSMUSG00000081360 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081370 0.05727410 9.36444e-02  2.18960e-02 0.0343115  0.00000e+00
ENSMUSG00000081390 0.00907964 1.78338e-02  4.30100e-02 0.0000000  1.35086e-02
ENSMUSG00000081400 0.02334000 5.37279e-02  0.00000e+00 0.0679511  9.87008e-02
ENSMUSG00000081410 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081420 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081440 0.05252400 8.26902e-02  1.62518e-01 0.1913190  1.05592e-01
ENSMUSG00000081450 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081460 0.00000000 4.06980e-02  0.00000e+00 0.0000000  2.99414e-02
ENSMUSG00000081470 0.02638720 1.23921e-01  3.54163e-01 0.1049310  1.14508e-01
ENSMUSG00000081480 0.04461430 0.00000e+00  0.00000e+00 0.0000000  4.89494e-02
ENSMUSG00000081490 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081500 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081510 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081520 0.00000000 1.23610e-01  1.06965e+00 0.0000000  9.01922e-02
ENSMUSG00000081530 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081540 0.00000000 0.00000e+00  0.00000e+00 0.0000000  5.77606e-02
ENSMUSG00000081550 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081560 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081570 0.00000000 0.00000e+00  0.00000e+00 0.0000000  3.66591e-02
ENSMUSG00000081580 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081590 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081600 0.10577100 2.66121e-02  6.73608e-01 0.0681934  1.15221e-01
ENSMUSG00000081610 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081620 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081630 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081640 0.00000000 0.00000e+00  3.95136e-02 0.1259820  2.56990e-01
ENSMUSG00000081650 0.00000000 1.42372e-39 1.53320e-233 0.1438880 6.09986e-254
ENSMUSG00000081660 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081670 0.00368657 0.00000e+00  0.00000e+00 0.0000000  2.91256e-02
ENSMUSG00000081680 0.00000000 4.29817e-02  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081690 0.00000000 0.00000e+00  0.00000e+00 0.1035380  0.00000e+00
ENSMUSG00000081700 0.52714800 6.40574e-01  1.76096e+00 3.9369200  2.36134e+00
ENSMUSG00000081720 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081730 0.02585980 8.62299e-02  1.05176e-01 0.0000000  0.00000e+00
ENSMUSG00000081740 0.11143400 1.28128e-01  2.14718e-01 0.1081290  1.87253e-01
ENSMUSG00000081750 0.00000000 1.13206e-01  1.37036e-01 0.0995484  8.50347e-02
ENSMUSG00000081770 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081800 0.00000000 0.00000e+00  0.00000e+00 0.5228580  9.02322e-01
ENSMUSG00000081810 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081820 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081830 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081840 0.00000000 0.00000e+00  0.00000e+00 0.0000000  8.33125e-02
ENSMUSG00000081850 0.00000000 0.00000e+00  0.00000e+00 0.0213764  0.00000e+00
ENSMUSG00000081860 0.00000000 6.89421e-02  0.00000e+00 0.0000000  1.01849e-01
ENSMUSG00000081870 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081880 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081890 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081900 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081910 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081920 0.00000000 6.97755e-02  6.88611e-02 0.1178060  2.64442e-02
ENSMUSG00000081930 0.00000000 0.00000e+00  0.00000e+00 0.0000000  2.28777e-02
ENSMUSG00000081940 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081950 0.00000000 0.00000e+00  0.00000e+00 0.0000000  1.98463e-01
ENSMUSG00000081960 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081970 0.51591900 9.45115e-02  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081980 0.00000000 0.00000e+00  0.00000e+00 0.0000000  0.00000e+00
ENSMUSG00000081990 0.14530100 1.73048e-01  0.00000e+00 0.0000000  0.00000e+00
                     sample4   sample6     sample12   sample3    sample11
ENSMUSG00000081000 0.0000000 0.0000000  4.30796e-02 0.0000000 0.00000e+00
ENSMUSG00000081010 0.4196660 0.2482440  5.94672e-01 0.2143470 4.15823e-01
ENSMUSG00000081020 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081030 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081050 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081060 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081070 0.1972550 0.1439340  8.82678e-02 0.0000000 8.55702e-02
ENSMUSG00000081080 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081100 0.5043170 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081110 0.0000000 0.0000000  3.10864e-01 0.0000000 0.00000e+00
ENSMUSG00000081120 0.0000000 0.0000000  0.00000e+00 0.0408195 0.00000e+00
ENSMUSG00000081130 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081150 0.0000000 0.0146228  0.00000e+00 0.0162030 0.00000e+00
ENSMUSG00000081160 0.0000000 0.0000000  0.00000e+00 0.0000000 4.24105e-01
ENSMUSG00000081170 0.0300449 0.0845798  2.56416e-02 0.0597709 0.00000e+00
ENSMUSG00000081180 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081200 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081210 0.0259691 0.0243380  2.22047e-02 0.0000000 0.00000e+00
ENSMUSG00000081220 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081230 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081240 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081250 0.0506275 0.1104960  1.44034e-02 0.0357261 5.89878e-02
ENSMUSG00000081260 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081270 0.0112396 0.0103406  2.29162e-01 0.0950715 2.90225e-02
ENSMUSG00000081280 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081290 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081300 0.0000000 0.0545545  2.40617e-02 0.0295514 0.00000e+00
ENSMUSG00000081310 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081320 0.0000000 0.0000000  0.00000e+00 0.0818319 0.00000e+00
ENSMUSG00000081330 0.0000000 0.0950554  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081340 0.2247430 0.1051720  3.99464e-01 1.8677500 4.09300e-01
ENSMUSG00000081350 0.1089630 0.0726467  7.86517e-02 0.0792945 3.53316e-02
ENSMUSG00000081360 0.0000000 0.0314025  0.00000e+00 0.0374285 0.00000e+00
ENSMUSG00000081370 0.0421598 0.0689326  5.23947e-02 0.0770847 8.38816e-02
ENSMUSG00000081390 0.0071164 0.0195862  6.78611e-03 0.0361030 3.80935e-02
ENSMUSG00000081400 0.0618234 0.0580507  0.00000e+00 0.0674159 0.00000e+00
ENSMUSG00000081410 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081420 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081440 0.1273620 0.1475540  5.49808e-02 0.0837032 3.73026e-02
ENSMUSG00000081450 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081460 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081470 0.0239154 0.0898210  1.40554e-01 0.1519990 5.52225e-02
ENSMUSG00000081480 0.0103467 0.0000000  3.48421e-02 0.0107177 1.41788e-01
ENSMUSG00000081490 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081500 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081510 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081520 0.0000000 0.0000000  0.00000e+00 0.1038290 0.00000e+00
ENSMUSG00000081530 0.0000000 0.0000000  1.61702e-01 0.0000000 0.00000e+00
ENSMUSG00000081540 0.0000000 0.0000000  5.14198e-02 0.0000000 0.00000e+00
ENSMUSG00000081550 0.0000000 0.0102009  0.00000e+00 0.0000000 4.18039e-02
ENSMUSG00000081560 0.0000000 0.0000000  3.10240e-03 0.0000000 0.00000e+00
ENSMUSG00000081570 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081580 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081590 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081600 0.0605787 0.1134160  6.73165e-02 0.0397673 4.51580e-02
ENSMUSG00000081610 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081620 0.0571851 0.0541486  2.19254e-06 0.0579367 0.00000e+00
ENSMUSG00000081630 0.0000000 0.0000000  0.00000e+00 0.0144917 0.00000e+00
ENSMUSG00000081640 0.0000000 0.0211881  1.70749e-01 0.0000000 1.01114e-01
ENSMUSG00000081650 0.0448670 0.0000000 2.41125e-244 0.0950681 2.09208e-77
ENSMUSG00000081660 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081670 0.0119842 0.0000000  2.68140e-03 0.0000000 7.58623e-03
ENSMUSG00000081680 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081690 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081700 0.4849380 0.0000000  4.20815e-01 0.0000000 0.00000e+00
ENSMUSG00000081720 0.2939240 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081730 0.0000000 0.0426079  1.15971e-01 0.1004120 0.00000e+00
ENSMUSG00000081740 0.0976122 0.2768850  8.49159e-02 0.0000000 0.00000e+00
ENSMUSG00000081750 0.0881494 0.0000000  0.00000e+00 0.0000000 9.62319e-02
ENSMUSG00000081770 0.0123680 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081800 0.0000000 0.4461050  3.79284e-01 0.0000000 0.00000e+00
ENSMUSG00000081810 0.0000000 0.0547575  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081820 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081830 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081840 0.0000000 0.0821355  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081850 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081860 0.0531812 0.1531220  0.00000e+00 0.0519515 0.00000e+00
ENSMUSG00000081870 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081880 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081890 0.0000000 0.0000000  0.00000e+00 0.0783868 0.00000e+00
ENSMUSG00000081900 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081910 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081920 0.0548575 0.0766305  1.00302e-01 0.0000000 3.44230e-02
ENSMUSG00000081930 0.0000000 0.0222406  0.00000e+00 0.0229968 0.00000e+00
ENSMUSG00000081940 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081950 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081960 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081970 0.0563853 0.0176324  1.10769e-01 0.3353480 2.21302e-02
ENSMUSG00000081980 0.0000000 0.0000000  0.00000e+00 0.0000000 0.00000e+00
ENSMUSG00000081990 0.0000000 0.0000000  1.18007e-01 0.0000000 3.13326e-01
                       sample10    sample1
ENSMUSG00000081000  0.00000e+00 0.00000000
ENSMUSG00000081010  4.52537e-01 0.23584800
ENSMUSG00000081020  0.00000e+00 0.00000000
ENSMUSG00000081030  0.00000e+00 0.00000000
ENSMUSG00000081050  0.00000e+00 0.00000000
ENSMUSG00000081060  0.00000e+00 0.00000000
ENSMUSG00000081070  4.73858e-02 0.01427330
ENSMUSG00000081080  0.00000e+00 0.00000000
ENSMUSG00000081100  0.00000e+00 0.00000000
ENSMUSG00000081110  0.00000e+00 0.00000000
ENSMUSG00000081120  0.00000e+00 0.00000000
ENSMUSG00000081130  0.00000e+00 0.00000000
ENSMUSG00000081150  0.00000e+00 0.04398270
ENSMUSG00000081160  0.00000e+00 0.00000000
ENSMUSG00000081170  0.00000e+00 0.02736590
ENSMUSG00000081180  0.00000e+00 0.00000000
ENSMUSG00000081200  0.00000e+00 0.00000000
ENSMUSG00000081210  0.00000e+00 0.00000000
ENSMUSG00000081220  0.00000e+00 0.00000000
ENSMUSG00000081230  0.00000e+00 0.00000000
ENSMUSG00000081240  0.00000e+00 0.00000000
ENSMUSG00000081250  0.00000e+00 0.06468100
ENSMUSG00000081260  0.00000e+00 0.09822360
ENSMUSG00000081270  2.43866e-01 0.22114700
ENSMUSG00000081280  0.00000e+00 0.00000000
ENSMUSG00000081290  0.00000e+00 0.00000000
ENSMUSG00000081300  0.00000e+00 0.00000000
ENSMUSG00000081310  0.00000e+00 0.00000000
ENSMUSG00000081320  0.00000e+00 0.07414980
ENSMUSG00000081330  0.00000e+00 0.03489590
ENSMUSG00000081340  1.87861e-01 0.22680200
ENSMUSG00000081350  7.22104e-02 0.02882380
ENSMUSG00000081360  1.13712e-01 0.00000000
ENSMUSG00000081370  4.95519e-02 0.05991200
ENSMUSG00000081390  1.34264e-02 0.00816612
ENSMUSG00000081400  0.00000e+00 0.06122950
ENSMUSG00000081410  0.00000e+00 0.00000000
ENSMUSG00000081420  0.00000e+00 0.00000000
ENSMUSG00000081440  1.27270e-01 0.06093470
ENSMUSG00000081450  0.00000e+00 0.00000000
ENSMUSG00000081460  0.00000e+00 0.02948170
ENSMUSG00000081470  1.90757e-01 0.18401900
ENSMUSG00000081480  0.00000e+00 0.01939520
ENSMUSG00000081490  0.00000e+00 0.03172180
ENSMUSG00000081500  0.00000e+00 0.00000000
ENSMUSG00000081510  0.00000e+00 0.00000000
ENSMUSG00000081520  0.00000e+00 0.00000000
ENSMUSG00000081530  0.00000e+00 0.00000000
ENSMUSG00000081540  0.00000e+00 0.00000000
ENSMUSG00000081550  3.91927e-02 0.01189620
ENSMUSG00000081560  0.00000e+00 0.00000000
ENSMUSG00000081570  0.00000e+00 0.03759050
ENSMUSG00000081580  0.00000e+00 0.00000000
ENSMUSG00000081590  0.00000e+00 0.00000000
ENSMUSG00000081600  6.09340e-02 0.10902500
ENSMUSG00000081610  0.00000e+00 0.00000000
ENSMUSG00000081620  0.00000e+00 0.00000000
ENSMUSG00000081630  0.00000e+00 0.00000000
ENSMUSG00000081640  0.00000e+00 0.02051630
ENSMUSG00000081650 2.02100e-208 0.00000000
ENSMUSG00000081660  0.00000e+00 0.00000000
ENSMUSG00000081670  0.00000e+00 0.00989694
ENSMUSG00000081680  0.00000e+00 0.00000000
ENSMUSG00000081690  1.63996e-01 0.00000000
ENSMUSG00000081700  0.00000e+00 0.45534200
ENSMUSG00000081720  0.00000e+00 0.00000000
ENSMUSG00000081730  1.49843e-01 0.06830410
ENSMUSG00000081740  0.00000e+00 0.00000000
ENSMUSG00000081750  0.00000e+00 0.07743630
ENSMUSG00000081770  0.00000e+00 0.00000000
ENSMUSG00000081800  1.42942e+00 0.00000000
ENSMUSG00000081810  0.00000e+00 0.05703180
ENSMUSG00000081820  0.00000e+00 0.00000000
ENSMUSG00000081830  0.00000e+00 0.00000000
ENSMUSG00000081840  0.00000e+00 0.08190040
ENSMUSG00000081850  0.00000e+00 0.00000000
ENSMUSG00000081860  0.00000e+00 0.00000000
ENSMUSG00000081870  0.00000e+00 0.00000000
ENSMUSG00000081880  0.00000e+00 0.00000000
ENSMUSG00000081890  0.00000e+00 0.00000000
ENSMUSG00000081900  0.00000e+00 0.00000000
ENSMUSG00000081910  0.00000e+00 0.00000000
ENSMUSG00000081920  4.82955e-02 0.11722600
ENSMUSG00000081930  0.00000e+00 0.00000000
ENSMUSG00000081940  0.00000e+00 0.00000000
ENSMUSG00000081950  3.46450e-01 0.00000000
ENSMUSG00000081960  0.00000e+00 0.00000000
ENSMUSG00000081970  6.22136e-02 0.26596500
ENSMUSG00000081980  0.00000e+00 0.00000000
ENSMUSG00000081990  0.00000e+00 0.00000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rpkm_data[<span class="fu">grep</span>(regexes[<span class="dv">2</span>], <span class="fu">rownames</span>(rpkm_data)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       sample2     sample5     sample7     sample8     sample9
ENSMUSG00000030074  0.20637600   0.0133865   0.0612572   0.1150200   0.0697535
ENSMUSG00000030075  2.33666000   1.3492500   1.8535600   1.1424600   1.2362400
ENSMUSG00000030077 16.14110000   2.7689800   2.3481000   2.6011400   2.6115000
ENSMUSG00000030079  3.60851000   4.2917600   3.2846100   6.2027900   5.6977500
ENSMUSG00000030170  0.05989460   0.0600771   0.2459500   0.3276650   0.3892750
ENSMUSG00000030172 35.25170000  20.5494000  11.8559000  13.0022000  12.0354000
ENSMUSG00000030173  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030177  0.00000000   0.0000000   0.6003390   1.0381100   1.0106200
ENSMUSG00000030178  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030270  0.66494200   0.0661059   0.1617390   0.2180730   0.2286060
ENSMUSG00000030271  2.04301000   3.4457800   2.5931400   2.4352500   2.8924600
ENSMUSG00000030272  5.08121000   5.5455900   4.9117200   7.0002900   9.8384400
ENSMUSG00000030275 71.76190000  53.7067000  48.9662000  42.4483000  38.2939000
ENSMUSG00000030276  1.97518000   3.1597000   1.7151700   2.1701800   2.8689800
ENSMUSG00000030278  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030279 10.20820000   9.0127400   5.3734900   5.8671100   5.9447100
ENSMUSG00000030373  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030374  6.58867000   5.7330300   3.9467100   3.8056400   3.9936900
ENSMUSG00000030376  0.87396800   0.0621262   0.2192290   0.2963300   0.6559060
ENSMUSG00000030378  0.00000000   0.0000000   0.0000000   0.0153495   0.0000000
ENSMUSG00000030470  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030471  5.88901000  16.2952000   3.5564400   5.5312900   5.8230100
ENSMUSG00000030472  0.00836035   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030474  0.00990759   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030577  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030579  0.05260400   0.0631277   0.0823306   0.0000000   0.0000000
ENSMUSG00000030670  5.10446000   0.3958210   0.1130280   0.0567055   0.1616280
ENSMUSG00000030671 14.77660000   1.6977000   1.6044300   0.7720800   1.4736500
ENSMUSG00000030672  0.54324600   1.9351900   1.5820900   0.8342890   1.9166100
ENSMUSG00000030674  0.00000000   0.0000000   0.4764780   0.1636520   0.1831090
ENSMUSG00000030677  0.68018300   0.9177370   0.3962670   0.6364730   0.8227140
ENSMUSG00000030678 12.61320000  16.9219000  11.0297000  15.0193000  14.9331000
ENSMUSG00000030770 44.97410000   5.1622500  22.5371000  18.8658000  21.6958000
ENSMUSG00000030771  0.08677560   0.0000000   0.1551500   0.1050040   0.1950270
ENSMUSG00000030772 54.27900000  75.0917000   5.1320900   4.5507700   4.8783100
ENSMUSG00000030774 30.79580000   8.4707100  69.2368000  67.6231000  67.7527000
ENSMUSG00000030775  0.00000000   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030779 40.34600000  15.8712000  11.1304000  12.6770000  16.5309000
ENSMUSG00000030870 24.84810000  18.4889000  17.9845000  18.1982000  19.0447000
ENSMUSG00000030871  0.64068300   0.8441390   0.5102840   0.5436110   0.5804900
ENSMUSG00000030872 21.53450000  37.8914000   3.2362800   5.2779200   4.7577500
ENSMUSG00000030873  0.00000000   0.0000000   0.0132390   0.0000000   0.0000000
ENSMUSG00000030876  3.30157000   3.2615900   3.9052900   8.4561100  10.3881000
ENSMUSG00000030877  0.03246930   0.0708122   0.1728210   0.1353880   0.0580233
ENSMUSG00000030878 14.05730000  11.3728000  20.6072000  21.3325000  20.8103000
ENSMUSG00000030879 84.20300000 149.3960000 151.5250000 191.7790000 184.0930000
ENSMUSG00000030970  2.22118000   0.5378520   2.2438100   2.5994000   3.5939700
ENSMUSG00000030972  0.00000000   0.0000000   0.0000000   0.0000000   0.0832298
ENSMUSG00000030976  0.03803630   0.0000000   0.0000000   0.0000000   0.0000000
ENSMUSG00000030978  1.83094000   0.9441210   1.6368600   1.5149200   1.4087400
ENSMUSG00000030979  7.42428000  14.6282000   6.0847000   7.2492800   6.6150800
                       sample4     sample6   sample12     sample3    sample11
ENSMUSG00000030074 0.00000e+00   0.0291724  0.1229840  0.17460700  0.07651200
ENSMUSG00000030075 1.03547e+00   0.8918970  7.6240800  2.09576000  7.10890000
ENSMUSG00000030077 3.55031e+00   3.3894900 12.3911000 17.40950000 19.41070000
ENSMUSG00000030079 4.70178e+00   4.6240400  5.6084100  4.23242000  5.28554000
ENSMUSG00000030170 1.02297e-01   0.0348348  0.0942575  0.04705470  0.06297680
ENSMUSG00000030172 2.10776e+01  23.1949000 45.9152000 44.83060000 39.73400000
ENSMUSG00000030173 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030177 5.21551e-01   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030178 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030270 1.70996e-01   0.1071400  8.5634100  1.20026000  6.71953000
ENSMUSG00000030271 3.29241e+00   3.3445900  2.4525200  1.16827000  3.48406000
ENSMUSG00000030272 5.62289e+00   6.0813100  7.0790400  4.84389000  6.44008000
ENSMUSG00000030275 5.67920e+01  47.9664000 64.7983000 84.23070000 65.81580000
ENSMUSG00000030276 1.80709e+00   2.6832000  3.8991300  2.78648000  2.67536000
ENSMUSG00000030278 0.00000e+00   0.0000000  0.2909060  0.00000000  0.00000000
ENSMUSG00000030279 1.09897e+01   9.4774500 10.7257000 11.58750000  9.57691000
ENSMUSG00000030373 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030374 5.83355e+00   7.3753300  7.1402200  6.37080000  6.64417000
ENSMUSG00000030376 5.25474e-02   0.1234100  1.1495200  0.81869300  1.81936000
ENSMUSG00000030378 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030470 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030471 1.79915e+01  17.4328000  8.9368500  6.93130000 10.34000000
ENSMUSG00000030472 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030474 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030577 0.00000e+00   0.0000000  0.0000000  0.00817220  0.00000000
ENSMUSG00000030579 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030670 4.61151e-01   0.5641390  0.3491230  5.45081000  0.26870800
ENSMUSG00000030671 1.91161e+00   2.3628600  5.0098600 13.99050000  3.67025000
ENSMUSG00000030672 2.93484e+00   1.3046600  2.7187300  1.25106000  1.59852000
ENSMUSG00000030674 1.75575e-02   0.0000000  0.3643380  0.05641660  0.26297700
ENSMUSG00000030677 5.69520e-01   0.7113590  2.3767800  0.42698800  1.78656000
ENSMUSG00000030678 1.57272e+01  20.3632000 17.7778000 12.58830000 17.52280000
ENSMUSG00000030770 4.06875e+00   3.1445500 17.4887000 41.82530000 11.58450000
ENSMUSG00000030771 9.47579e-03   0.0089190  0.0287954  0.07294370  0.04995530
ENSMUSG00000030772 7.53729e+01  83.1674000 11.1374000 66.36510000  8.19865000
ENSMUSG00000030774 6.68499e+00   7.9819700 25.8756000 30.53650000 20.09400000
ENSMUSG00000030775 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00000000
ENSMUSG00000030779 1.73307e+01  14.5697000 53.9570000 40.71080000 50.02630000
ENSMUSG00000030870 1.88126e+01  17.8138000 20.1388000 27.41960000 22.22650000
ENSMUSG00000030871 6.30509e-01   0.7676120  0.8915580  0.76229600  0.87410300
ENSMUSG00000030872 3.94705e+01  37.3549000 20.5128000 25.73480000 17.62530000
ENSMUSG00000030873 0.00000e+00   0.0000000  0.0000000  0.00000000  0.00833236
ENSMUSG00000030876 3.33462e+00   3.7663300  3.9197200  3.15634000  2.97219000
ENSMUSG00000030877 2.62000e-02   0.0229823  0.0000000  0.12591100  0.28712500
ENSMUSG00000030878 1.00931e+01  11.6458000 16.1902000 13.68670000 12.38450000
ENSMUSG00000030879 1.96557e+02 182.6510000 99.4870000 60.55510000 96.11420000
ENSMUSG00000030970 1.75380e-01   0.4354840  0.9641690  2.15149000  0.96352300
ENSMUSG00000030972 0.00000e+00   0.0000000  0.0000000  0.00987532  0.00000000
ENSMUSG00000030976 0.00000e+00   0.0000000  0.0289630  0.01840510  0.00000000
ENSMUSG00000030978 1.28609e+00   1.5986900  2.9124400  1.54334000  2.76794000
ENSMUSG00000030979 1.37998e+01  14.1101000  9.2110300  8.12846000  7.49274000
                      sample10     sample1
ENSMUSG00000030074   0.0000000  0.10624200
ENSMUSG00000030075   6.9174900  2.35778000
ENSMUSG00000030077  18.1342000 21.22800000
ENSMUSG00000030079   4.6592600  3.90293000
ENSMUSG00000030170   0.0712690  0.07750520
ENSMUSG00000030172  40.5971000 42.42630000
ENSMUSG00000030173   0.0000000  0.00000000
ENSMUSG00000030177   0.0000000  0.00000000
ENSMUSG00000030178   0.0000000  0.00000000
ENSMUSG00000030270   6.3930500  1.02800000
ENSMUSG00000030271   3.6347100  1.76838000
ENSMUSG00000030272   5.9450300  5.13694000
ENSMUSG00000030275  67.9997000 79.90400000
ENSMUSG00000030276   3.5075900  2.64830000
ENSMUSG00000030278   0.0000000  0.00000000
ENSMUSG00000030279   9.8767300 12.08380000
ENSMUSG00000030373   0.0000000  0.00000000
ENSMUSG00000030374   5.4757700  4.60863000
ENSMUSG00000030376   1.6399200  1.08756000
ENSMUSG00000030378   0.0000000  0.00000000
ENSMUSG00000030470   0.0000000  0.00000000
ENSMUSG00000030471  10.4466000  6.32738000
ENSMUSG00000030472   0.0000000  0.00726246
ENSMUSG00000030474   0.0000000  0.00000000
ENSMUSG00000030577   0.0000000  0.00000000
ENSMUSG00000030579   0.0758163  0.00000000
ENSMUSG00000030670   0.2198540  6.28952000
ENSMUSG00000030671   4.5651500 13.80330000
ENSMUSG00000030672   1.5528100  0.46902400
ENSMUSG00000030674   0.3290180  0.05997590
ENSMUSG00000030677   1.9111300  0.65789100
ENSMUSG00000030678  17.9688000 14.17210000
ENSMUSG00000030770  13.7546000 46.20650000
ENSMUSG00000030771   0.1825680  0.07760820
ENSMUSG00000030772  13.2551000 72.54180000
ENSMUSG00000030774  20.5969000 33.81660000
ENSMUSG00000030775   0.0000000  0.00000000
ENSMUSG00000030779  47.4036000 48.75910000
ENSMUSG00000030870  21.7020000 26.15860000
ENSMUSG00000030871   0.7805900  0.73538600
ENSMUSG00000030872  16.7761000 23.47660000
ENSMUSG00000030873   0.0000000  0.00000000
ENSMUSG00000030876   3.4585600  3.29226000
ENSMUSG00000030877   0.0000000  0.05516930
ENSMUSG00000030878  14.5093000 16.59370000
ENSMUSG00000030879 102.6180000 81.87120000
ENSMUSG00000030970   1.0145200  2.97142000
ENSMUSG00000030972   0.0148159  0.00447713
ENSMUSG00000030976   0.0000000  0.00000000
ENSMUSG00000030978   2.7196800  2.09766000
ENSMUSG00000030979   7.2321400  8.89284000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Another way yo do things using do.call, rbind, and lapply </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>get_fuzzygene <span class="ot">&lt;-</span> <span class="cf">function</span>(x){rpkm_data[<span class="fu">grep</span>(x, <span class="fu">rownames</span>(rpkm_data)),]}</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>ans4 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(regexes,get_fuzzygene))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="reordering-data-using-match" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="reordering-data-using-match"><span class="header-section-number">18.3</span> Reordering data using <code>match</code></h2>
<p>We can use the <code>match()</code> function to match the values in two vectors. We’ll be using it to evaluate which values are present in both vectors, and how to reorder the elements to make the values match.</p>
<p>match() takes 2 arguments. The first argument is a vector of values in the order you want, while the second argument is the vector of values to be reordered such that it will match the first:</p>
<ol type="1">
<li>a vector of values in the order you want</li>
<li>a vector of values to be reordered</li>
</ol>
<p>The function returns the position of the matches (indices) with respect to the second vector, which can be used to re-order it so that it matches the order in the first vector. Let’s use match() on the first and second vectors we created.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>second <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"A"</span>,<span class="st">"C"</span>)  <span class="co"># same letters but different order</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(first,second)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 1 5 2 3</code></pre>
</div>
</div>
<p>The output is the indices for how to reorder the second vector to match the first. <em>These indices match the indices that we derived manually before.</em></p>
<p>Now, we can just use the indices to reorder the elements of the <code>second</code> vector to be in the same positions as the matching elements in the <code>first</code> vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving indices for how to reorder `second` to match `first`</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>reorder_idx <span class="ot">&lt;-</span> <span class="fu">match</span>(first,second) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we can use those indices to reorder the second vector similar to how we ordered with the manually derived indices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordering the second vector to match the order of the first vector</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>second[reorder_idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "B" "C" "D" "E"</code></pre>
</div>
</div>
<p>If the output looks good, we can save the reordered vector to a new variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reordering and saving the output to a variable</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>second_reordered <span class="ot">&lt;-</span> second[reorder_idx]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/match3-reordered.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">matching7</figcaption><p></p>
</figure>
</div>
<p>Now that we know how <code>match()</code> works, let’s change vector <code>second</code> so that only a subset are retained:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>first <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>second <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>)  <span class="co"># remove values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img/match2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">matching5</figcaption><p></p>
</figure>
</div>
<p>And try to <code>match()</code> again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(first,second)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  3  2 NA  1 NA</code></pre>
</div>
</div>
<p>We see that the <code>match()</code> function takes every element in the first vector and finds the position of that element in the second vector, and if that element is not present, will return a missing value of NA. The value NA represents missing data for any data type within R. In this case, we can see that the <code>match()</code> function output represents the value at position 3 as first, which is A, then position 2 is next, which is B, the value coming next is supposed to be C, but it is not present in the <code>second</code> vector, so NA is returned, so on and so forth.</p>
<blockquote class="blockquote">
<p><strong>NOTE:</strong> For values that don’t match by default return an <code>NA</code> value. You can specify what values you would have it assigned using <code>nomatch</code> argument. Also, if there is more than one matching value found only the first is reported.</p>
</blockquote>
<p>If we rearrange <code>second</code> using these indices, then we should see that all the values present in both vectors are in the same positions and NAs are present for any missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>second[<span class="fu">match</span>(first, second)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "B" NA  "D" NA </code></pre>
</div>
</div>
<section id="reordering-genomic-data-using-match-function" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="reordering-genomic-data-using-match-function"><span class="header-section-number">18.3.1</span> Reordering genomic data using <code>match()</code> function</h3>
<p>While the input to the <code>match()</code> function is always going to be to vectors, often we need to use these vectors to reorder the rows or columns of a data frame to match the rows or columns of another dataframe. Let’s explore how to do this with our use case featuring RNA-seq data. To perform differential gene expression analysis, we have a data frame with the expression data or counts for every sample and another data frame with the information about to which condition each sample belongs. For the tools doing the analysis, the samples in the counts data, which are the column names, need to be the same and in the same order as the samples in the metadata data frame, which are the rownames.</p>
<p>We can take a look at these samples in each dataset by using the <code>rownames()</code> and <code>colnames()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check row names of the metadata</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sample1"  "sample2"  "sample3"  "sample4"  "sample5"  "sample6" 
 [7] "sample7"  "sample8"  "sample9"  "sample10" "sample11" "sample12"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the column names of the counts data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rpkm_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sample2"  "sample5"  "sample7"  "sample8"  "sample9"  "sample4" 
 [7] "sample6"  "sample12" "sample3"  "sample11" "sample10" "sample1" </code></pre>
</div>
</div>
<p>We see the row names of the metadata are in a nice order starting at <code>sample1</code> and ending at <code>sample12</code>, while the column names of the counts data look to be the same samples, but are randomly ordered. Therefore, we want to reorder the columns of the counts data to match the order of the row names of the metadata. To do so, we will use the <code>match()</code> function to match the row names of our metadata with the column names of our counts data, so these will be the arguments for match.</p>
<p>To do so, we will use the match function to match the row names of our metadata with the column names of our counts data, so these will be the arguments for <code>match()</code>.</p>
<p>Within the <code>match()</code> function, the rownames of the metadata is the vector in the order that we want, so this will be the first argument, while the column names of the count or rpkm data is the vector to be reordered. We will save these indices for how to reorder the column names of the count data such that it matches the rownames of the metadata to a variable called <code>genomic idx</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>genomic_idx <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(metadata), <span class="fu">colnames</span>(rpkm_data))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>genomic_idx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 12  1  9  6  2  7  3  4  5 11 10  8</code></pre>
</div>
</div>
<p>The <code>genomic_idx</code> represents how to re-order the column names in our counts data to be identical to the row names in metadata.</p>
<p>Now we can create a new counts data frame in which the columns are re-ordered based on the <code>match()</code> indices. Remember that to reorder the rows or columns in a data frame we give the name of the data frame followed by square brackets, and then the indices for how to reorder the rows or columns.</p>
<p>Our <code>genomic_idx</code> represents how we would need to reorder the <strong>columns</strong> of our count data such that the column names would be in the same order as the row names of our metadata. Therefore, we need to add our <code>genomic_idx</code> to the <strong>columns position</strong>. We are going to save the output of the reordering to a new data frame called <code>rpkm_ordered</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the counts data frame to have the sample names in the same order as the metadata data frame</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>rpkm_ordered  <span class="ot">&lt;-</span> rpkm_data[ , genomic_idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check and see what happened by clicking on the <code>rpkm_ordered</code> in the Environment window or using the <code>View()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the reordered counts</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(rpkm_ordered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see the sample names are now in a nice order from sample 1 to 12, just like the metadata. One thing to note is that you would never want to rearrange just the column names without the rest of the column because that would dissociate the sample name from it’s values.</p>
<p>You can also verify that column names of this new data matrix matches the metadata row names by using the <code>all</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">rownames</span>(metadata) <span class="sc">==</span> <span class="fu">colnames</span>(rpkm_ordered))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Now that our samples are ordered the same in our metadata and counts data, <strong>if these were raw counts (not RPKM)</strong> we could proceed to perform differential expression analysis with this dataset.</p>
<hr>
<p><strong>Exercises: Adding data from biomaRt</strong></p>
<p>Let’s convert these ensembl ID’s into gene symbols. There are a number of ways to do this in R, but we will be using the <code>biomaRt</code> package. <a href="https://useast.ensembl.org/info/data/biomart/biomart_r_package.html">BiomaRt</a> lets us easily map a variety of biological identifiers and choose a data source or ‘mart’. We can see a list of available dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biomaRt, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">listEnsembl</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        biomart                version
1         genes      Ensembl Genes 109
2 mouse_strains      Mouse strains 109
3          snps  Ensembl Variation 109
4    regulation Ensembl Regulation 109</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For a reproducible analysis, it's good to always specify versions of databases</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ensembl <span class="ot">=</span> <span class="fu">useEnsembl</span>(<span class="at">biomart=</span><span class="st">"ensembl"</span>,<span class="at">version=</span><span class="dv">109</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">listDatasets</span>(ensembl)[<span class="dv">100</span><span class="sc">:</span><span class="dv">110</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      dataset                                   description
100    mmmarmota_gene_ensembl               Alpine marmot genes (marMar2.1)
101   mmonoceros_gene_ensembl                 Narwhal genes (NGI_Narwhal_1)
102 mmoschiferus_gene_ensembl Siberian musk deer genes (MosMos_v2_BIUU_UCD)
103     mmulatta_gene_ensembl                       Macaque genes (Mmul_10)
104     mmurdjan_gene_ensembl       Pinecone soldierfish genes (fMyrMur1.1)
105     mmurinus_gene_ensembl                  Mouse Lemur genes (Mmur_3.0)
106    mmusculus_gene_ensembl                          Mouse genes (GRCm39)
107  mnemestrina_gene_ensembl           Pig-tailed macaque genes (Mnem_1.0)
108 mochrogaster_gene_ensembl                Prairie vole genes (MicOch1.0)
109      mpahari_gene_ensembl           Shrew mouse genes (PAHARI_EIJ_v1.1)
110       mpfuro_gene_ensembl                   Ferret genes (MusPutFur1.0)
               version
100          marMar2.1
101      NGI_Narwhal_1
102 MosMos_v2_BIUU_UCD
103            Mmul_10
104         fMyrMur1.1
105           Mmur_3.0
106             GRCm39
107           Mnem_1.0
108          MicOch1.0
109    PAHARI_EIJ_v1.1
110       MusPutFur1.0</code></pre>
</div>
</div>
<p>We want to convert ensembl gene ID’s into MGI gene symbols. We can use the <code>getBM</code> function to get a dataframe of our mapped identifiers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>ensembl <span class="ot">=</span> <span class="fu">useEnsembl</span>(<span class="at">biomart=</span><span class="st">"ensembl"</span>, <span class="at">dataset=</span><span class="st">"mmusculus_gene_ensembl"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>gene_map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(<span class="at">filters=</span> <span class="st">"ensembl_gene_id"</span>, <span class="at">attributes=</span> <span class="fu">c</span>(<span class="st">"ensembl_gene_id"</span>,<span class="st">"mgi_symbol"</span>), <span class="at">values =</span> <span class="fu">rownames</span>(rpkm_data), <span class="at">mart=</span>ensembl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Basic
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Try to replace the current rownames in <code>rpkm_data</code> with their mapped gene symbol. You may need to add a new column with the data instead.</p></li>
<li><p>Use the <code>match()</code> function to subset the <code>metadata</code> data frame so that the row names of the <code>metadata</code> data frame match the column names of the `rpkm_data`` data frame.</p></li>
</ol>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(rpkm_data), gene_map<span class="sc">$</span>ensembl_gene_id)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames(rpkm_data) &lt;- gene_map$mgi_symbol[ind] #oh no! duplicate rownames</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>rpkm_data<span class="sc">$</span>gene <span class="ot">&lt;-</span> gene_map<span class="sc">$</span>mgi_symbol[ind]</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">colnames</span>(rpkm_data), <span class="fu">rownames</span>(metadata))</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>metadata[idx, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         genotype celltype replicate
sample2        Wt    typeA         2
sample5        KO    typeA         2
sample7        Wt    typeB         1
sample8        Wt    typeB         2
sample9        Wt    typeB         3
sample4        KO    typeA         1
sample6        KO    typeA         3
sample12       KO    typeB         3
sample3        Wt    typeA         3
sample11       KO    typeB         2
sample10       KO    typeB         1
sample1        Wt    typeA         1
NA           &lt;NA&gt;     &lt;NA&gt;        NA</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout-caution callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Advanced
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can use the <code>listAttributes()</code> and <code>listFilters()</code> functions to see what other information we can get using <code>getBM</code>. Choose another piece of data to add to <code>rpkm_data</code>.</p>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Solutions will vary, but generally are similar to the basic and challenge solutions in how they get data and add it to the dataframe.</p>
</div>
</div>
</div>
<div class="callout-important callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Challenge
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>getBM</code> to find all genes on chromosomes 2, 6, or 9. Create another dataframe only containing these genes.</p>
</div>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the chomosome annotations</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>chrom_map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(<span class="at">filters=</span> <span class="st">"ensembl_gene_id"</span>, <span class="at">attributes=</span> <span class="fu">c</span>(<span class="st">"ensembl_gene_id"</span>,<span class="st">"chromosome_name"</span>), <span class="at">values =</span> <span class="fu">rownames</span>(rpkm_data), <span class="at">mart=</span>ensembl)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">#not strictly needed, but let's make chromosome a factor</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>chrom_map<span class="sc">$</span>chromosome_name <span class="ot">&lt;-</span> <span class="fu">factor</span>(chrom_map<span class="sc">$</span>chromosome_name)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">#We could either first map to rpkm_data and then filter, or filter chrom_map and then map to rpkm_data. Let's do the latter. </span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>chrom_map_269 <span class="ot">&lt;-</span> chrom_map[chrom_map<span class="sc">$</span>chromosome_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2"</span>,<span class="st">"6"</span>,<span class="st">"9"</span>),]</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>rpkm_chrom29 <span class="ot">&lt;-</span> rpkm_data[<span class="fu">rownames</span>(rpkm_data) <span class="sc">%in%</span> chrom_map_269<span class="sc">$</span>ensembl_gene_id,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
<p><em>The materials in this lesson have been adapted from work created by the (HBC)](http://bioinformatics.sph.harvard.edu/) and Data Carpentry (http://datacarpentry.org/). These are open access materials distributed under the terms of the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution license</a> (CC BY 4.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</em></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../session3/wrangling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../session3/tidyverse.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Tidyverse</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>