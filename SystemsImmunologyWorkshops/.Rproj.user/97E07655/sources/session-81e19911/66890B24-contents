# P Values and Multiple Hypotheses

### Interpreting p values

Let's start by checking our understanding of a p value.

::: {.callout-caution appearance="simple" icon="false"}
Are these statements correct or incorrect interpretations of p values?

1.  We can use the quantity $1-p$ to represent the probability that the alternative hypothesis is true.

2.  A p value can let us know how incompatible an observation is with a specified statistical model.

3.  A p value tells us how likely we would be to randomly see the observed value with minimal assumptions.

4.  A p value indicates an important result.
:::

### The Multiple Testing Problem

In modern biology, we are often conducting hundreds or thousands of statistical tests on high-throughput data. 
This means that even a low false positive rate can cause there to be a large number of cases where we falsely reject the null hypothesis. 







There is a [xkcd comic](http://xkcd.com/882) which illustrates this issue in the context of selective reporting. 

```{r}

X_MEAN = sample(1:1000, 1)
X_SD = sample(1:10, 1)
Y_MEAN = sample(1:1000, 1)
Y_SD = sample(1:10, 1)

x = rnorm(1000, mean=X_MEAN, sd=X_SD)
y = rnorm(1000, mean=Y_MEAN, sd=Y_SD)

og_data = data.frame(x=x, y=y)

og_data %>%
  ggplot(aes(x = x,
             y = y)) +
  geom_point() +
  theme_minimal() +
  labs(title = "Random Y by Random X")

NUM_HACKS = 1000

test_coef = c()
test_p = c()
size_v = c()
for (i in c(1:NUM_HACKS)) {
  new_x = sample(x)
  # new_x = rnorm(1000, mean=X_MEAN, sd=X_SD)
  new_test = summary(lm(y ~ new_x))
  test_coef[i] = new_test$coefficients[2]
  test_p[i] = new_test$coefficients[8]
}

d = data.frame(coef = test_coef,
               p = test_p)

d %>%
  ggplot(aes(x = test_coef,
             y = test_p)) +
  geom_point() +
  geom_hline(yintercept = .05, linetype = "dotted") +
  labs(x = "Coefficient",
       y = "P-value",
       title = "Statistics for randomly shuffled splits") +
  theme_minimal()

nrow(filter(d, test_p < .05))/nrow(d)
```
